<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<title>Vad ska jag prata om?!</title>
		<meta
			name="description"
			content="Visst är det väl en jävla pina att alltid komma på något att prata om? Låt oss fixa det. Här får du exempel på saker som ni kan prata om."
		/>
		<meta name="theme-color" content="#0d1117" />
		<meta name="author" content="Fredrik Hoffmann mrhoffmann@github.com" />
		<?xml version="1.0" ?>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="css.css">
	</head>

	<body>
		<span
			>Inget på denna sida får tas på allvar. "visste du" kan vara
			utdaterat.</span
		>
		<h1 id="container" onclick="copy()"></h1>
		<div id="unsafe_container"><input type="checkbox" id="unsafe" onclick="unsafe_check(this)"></input><label for="unsafe" id="unsafe_text">Inkludera NSFW</label></div>
		<div id="input-wrapper">
			<input type="text" id="filter" autocomplete="off" placeholder="Sök" />
		</div>
		<div id="links">
			<a href="" id="link"></a>
		</div>
		<div id="buttons">
			<div id="wrapper">
				<button
					onclick="questions.decrement()"
					id="prev"
					aria-label="Förra"
					title="Förra"
				>
					<
				</button>
				<button
					onclick="questions.randomize()"
					id="rand"
					aria-label="Slumpa"
					title="Slumpa"
				></button>
				<button
					onclick="questions.increment()"
					id="next"
					aria-label="Nästa"
					title="Nästa"
				>
					>
				</button>
			</div>
		</div>

		<script src="js.js"></script>
		<script>
			const questions = new Selected();
			const originalTopics = questions.topics;
			const inputText = document.getElementById('filter');
			const parm = questions.parseParam('question');
			if (parm != null) {
				inputText.value = parm != null ? parm : '';
				questions.doFilterSearch(parm);
			}
			const copy = () => {
				const textarea = document.createElement('textarea');
				textarea.value = document.getElementById('container').innerText;
				document.body.appendChild(textarea);
				textarea.select();

				try {
					document.execCommand('copy');
					questions.sendNotification('Kopierat.');
				} catch {
					//naj
				}
				document.body.removeChild(textarea);
			};

			inputText.addEventListener('input', (event) => {
				questions.doFilterSearch(event.target.value);
				inputText.style.width = inputText.value.length + 'ch';
			});

			document.addEventListener('keydown', function (event) {
				if (event.ctrlKey && event.code === 'KeyC') {
					copy();
				}
			});

			const unsafe_check = (event) => {
				questions.topics = event.checked ? originalTopics.concat(questions.sensitive_topis) : originalTopics;
				questions.updateDisplay();
			}

			(function() {
				if(questions.parseParam("topic") === undefined){
					questions.randomize();
				} else {
					let value = questions.parseParam("topic");
					if(value.length > 0){
						questions.counter = Number(questions.parseParam("topic"));
						questions.updateDisplay();
					}
					else{
						questions.randomize();
					}
				}
			})();
		</script>
	</body>
</html>
